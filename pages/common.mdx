import { FileTree, Tabs, Tab } from 'nextra/components'

# 4. Общие правила

## 4.1. Пакетный менеджер (npm, yarn, pnpm)

❗В проекте должен быть только 1 пакетный менеджер

## 4.2. [Переменные (const, let, var)](https://google.github.io/styleguide/tsguide.html#variables)

- Для объявления переменных всегда используйте `const` или `let`.
- По умолчанию используйте `const`, если только переменную не нужно переназначить.
- ❗Никогда не используйте `var`.

## 4.3. Аргументы функции

❗ Избегайте большого количества аргументов. Если больше 2-х аргументов, то объединяем их в объект

```ts showLineNumbers {2,7}
// ❌
const createTodolist1 = (id: string, title: string, author: string) => {
  // code
}

// ✅
const createTodolist2 = (todo: Todo) => {
  const { id, title, author } = todo
  // code
}
```

## 4.4. Утилитные функции (utils, helpers)

- Если утилитная функция используется во многих местах проектах, то выносим ее в `common/utils`
- Если функция необходима чтобы не замогрождать логику компонента, то кладем ее рядом с компонентой / фичей
  (в зависимости от структуры папок в приложении)
- Желательно покрывать логику утилит тестами

## 4.5. Утилитные функции, кастомные хуки и т.д. дробим на несколько файлов, т.е. не создаем файл utils куда все складываем

```ts showLineNumbers filename="utils.ts"
// ❌
export const handleServerAppError = () => {}
export const handleServerNetworkError = () => {}
```

```ts showLineNumbers filename="handleServerAppError.ts"
// ✅
export const handleServerAppError = () => {}
```

```ts showLineNumbers filename="handleServerNetworkError.ts"
// ✅
export const handleServerNetworkError = () => {}
```

## 4.6. Однострочный метод
⚡ Однострочный метод должен выглядеть так же как и обычный метод

Когда в теле функции несколько строк кода, тогда все однозначно. Пишем вот так

```ts showLineNumbers
if (a> 10) {
  // code 1
  // code 2
  // code 3
}
```
Разногласия возникают, когда в теле функции одна строка кода. Смотри примеры ниже

```ts showLineNumbers filename="example1"
// ❌
if (a>10) code 1

// ✅
if (a>10) {
  // code 1
}
```

```ts showLineNumbers filename="example2" {4, 10-12}
// ❌
const deletedTodosArray = produce(todosArray, draft => {
    const index = draft.findIndex(todo => todo.id === "id1")
    if (index !== -1) draft.splice(index, 1)
})

// ✅
const deletedTodosArray = produce(todosArray, draft => {
    const index = draft.findIndex(todo => todo.id === "id1")
    if (index !== -1) {
      draft.splice(index, 1)
    }
})
```

## 4.7. Imports

- В React (CRA) используем абсолютные пути

```json showLineNumbers filename="tsconfig.json" {4}
{
  "compilerOptions": {
    "target": "es5",
    "baseUrl": "src"
}
```

- В Next.js используем alias

## 4.8. Re-export from index.ts

⚡ Используем re-export при помощи `index.ts`

<Tabs items={['useDebounce.ts', 'useLocalStorage.ts', 'index.ts']} defaultIndex="2">
    <Tab>
        ```tsx
        export const useDebounce = () => {}
        ```
    </Tab>
    <Tab>
        ```tsx
        export const useLocalStorage = () => {}
        ```
    </Tab>
    <Tab>
        ```tsx
        export {useDebounce} from "./useDebounce"
        export {useLocalStorage} from "./useLocalStorage"
        ```
    </Tab>
</Tabs>

<FileTree.Folder name="hooks" defaultOpen>
  <FileTree.File name="useDebounce.ts" />
  <FileTree.File name="useLocalStorage.ts" />
  <FileTree.File name="index.ts" />
</FileTree.Folder>
